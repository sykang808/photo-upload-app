# Front-end of Coffee Listing App

Using:

- [React](https://reactjs.org/)
- [Snowpack](https://www.snowpack.dev/)

## Getting started

After cloning the repository:

```
npm install
npm start
```

To generate the build folder:

```
npm run build
```

This will generate a `src/build` folder to be deployed

## How to configure the back-end

Copy or rename `.env.example` to `.env` and update each variable value,

There's three variables we need to configure:

```
SNOWPACK_PUBLIC_CLOUDFRONT_URL=
SNOWPACK_PUBLIC_API_IMAGES_URL=
SNOWPACK_PUBLIC_API_LIKES_URL=
```

# Back-end API Contract

### 1. Variable: `SNOWPACK_PUBLIC_CLOUDFRONT_URL` (Get This Value On Section 00 to Section 06)

The CloudFront URL to be used to access uplodaded images.

Origin should be the bucket we upload images to.

**Important: You get this value when deploying the application from Section 00 to Section 06**

### 2. Variable: `SNOWPACK_PUBLIC_API_IMAGES_URL` (Get This Value On Section 00 to Section 06)

GET endpoint returning all images uploaded in the target bucket sorted by their `LastModified` key.

Should respect the **API CONTRACT**:

```
curl API_GET_ALL_S3_ITEMS_URL
[{ id, url: item.Key }, { id, url: item.Key }]
```

Sample code provided on [docs/lambda-sample-code/api-get-all-s3-items.js](./docs/lambda-sample-code/api-get-all-s3-items.js)

**Important: You get this value when deploying the application from Section 00 to Section 06**

### 3. Variable `SNOWPACK_PUBLIC_API_IMAGES_URL` (Get This Value On Section 00 to Section 06)

POST endpoint returning an object with the presigned post url to upload a file to s3.

Body payload required: `fileName` - including the extension, e.g. "my-image.png"

Should respect the **API CONTRACT**:

```
curl -X POST -d '{ "fileName": "image-for-test.png" }' API_POST_CREATE_S3_PRESIGNED_POST_URL
{"url":"https://s3.amazonaws.com/__BUCKET_NAME__", "fields":{"key":"" ... }}
```

Sample code provided on [docs/lambda-sample-code/api-post-create-s3-presigned-post-url.js](./docs/lambda-sample-code/api-post-create-s3-presigned-post-url.js)

**Important: You get this value when deploying the application from Section 00 to Section 06**

### 4. Variable `SNOWPACK_PUBLIC_API_LIKES_URL` (Get This Value On Section 03 to Section 06)

GET endpoint retuning all likes for a `imageKeyS3` in the path paramemter (e.g. `api-url/:imageKeyS3`).

Required `:imageKeyS3` in as path parameter and returns the DynamoDB `.query` response,

Should respect the **API CONTRACT**:

```
curl SNOWPACK_PUBLIC_API_GET_ALL_LIKES_FOR_IMAGE_KEY_S3_URL + "/:imageKeyS3"
{"Items":[{"imageKeyS3":"eb5bf89cdc.png","likes":8}],"Count":1,"ScannedCount":1}
```

Sample code provided on [docs/lambda-sample-code/api-get-all-likes-for-image-key-s3-url.js](./docs/lambda-sample-code/api-get-all-likes-for-image-key-s3-url.js)

**Important: You get this value when deploying the application from Section 03 to Section 06**

### 5. Variable `SNOWPACK_PUBLIC_API_LIKES_URL` (Get This Value On Section 03 to Section 06)

POST endpoint to update likes for an `imageKeyS3` and returns the DynamoDB `.update` response,

Body payload required:

- `imageKeyS3` - the image key on the upload s3 bucket, generated by the lambda on `API_POST_CREATE_S3_PRESIGNED_POST_URL`
- `likes` - either a positive or negative number (e.g. `-1` or `1`)

Should respect the **API CONTRACT**:

```
curl -X POST -d '{ "imageKeyS3": "eb5bf89cdc.png", "likes": -1 }' API_POST_UPDATE_LIKES_FOR_IMAGE_KEY_S3_URL
{"Attributes":{"imageKeyS3":"eb5bf89cdcd311b06c55bb25f86ced30-picture.png","likes":8}}
```

Sample code provided on [docs/lambda-sample-code/api-post-update-likes-for-image-key-s3-url.js](./docs/lambda-sample-code/api-post-update-likes-for-image-key-s3-url.js)

**Important: You get this value when deploying the application from Section 03 to Section 06**
